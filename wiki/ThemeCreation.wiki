#summary About custom theme creation

= Prerequisites =

  * Knowledge of Android SDK & dev tools - Sorry, theme creation is not user-friendly for the moment at is relies on the Android SDK theme framework.
  * 9-patch graphic for button.
  * 9-patch graphic + toggle on/off for the toggle button, if you're brave.

= Background =

The theme system relies on the Android theme framework, so if you've already made themes for other applications there is no particular difficulty.

However, if it's your first theme creation as it was for me, there are some subtle things to know. The difficult part was to understand the general theme organisation:
  * A theme files references styles
    * Styles can reference a `drawable`, for example for background
      * This `drawable` can be an image (PNG), but can also be an XML file ! XML files in this case are kind of "composite drawables" that allow to define different drawable depending of the state of the button, for example.
      * There are several kind of XML files, the 2 interesting are `<selector>` and `<layer-list>`
        * `<selector>` allows to specify multiple drawing depending on View attributes value (button state for example: has focus, is disabled, is pressed, etc.)
        * `<layer-list>` allows to make a composite `drawable` by layering multiple image (or other XML files !)

As far as I know this is not really documented, I had to go to Android sources to understand that.

== The Theme file ==

The theme file defines global Theme metadata, as some global colors and properties, but also defines a list of styles that composes the Theme. Let's take an example with the default Android theme file:

http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=core/res/res/values/themes.xml

{{{
<resources>
 <style name="Theme"> <!-- Name of the theme -->
  <!-- Some global color and style attributes -->
  <item name="colorForeground">@android:color/bright_foreground_dark</item>
  ...

  <!-- Some style definitions. In this case, it indicates that the style of the buttons is defined by the "Widget.Button" style, which is not in this file -->
  <item name="buttonStyle">@android:style/Widget.Button</item>
  ...
}}}

So the theme file is just a "map" indicating which styles to apply to each component. The real styles attributes (color, drawables, etc.) is in the styles file.

== The Styles file ==

The Styles files contain the style attributes like text color, background drawables, etc. for each defined style. Let's have a look at the Android style file :

http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=core/res/res/values/styles.xml

{{{
<resources>
 ...
 <style name="Widget.Button">
  <item name="android:background">@android:drawable/btn_default</item>
  <item name="android:textAppearance">?android:attr/textAppearanceSmallInverse</item>
  ...
 </style>
}}}

The style Widget.Button uses a `drawable` as background. But if you search for the corresponding PNG file (btn_default.9.png) in the `drawable/` directory you'll not find it ! Instead you'll find an XML file with the following contents:

http://android.git.kernel.org/?p=platform/frameworks/base.git;a=blob;f=core/res/res/drawable/btn_default.xml

{{{
<selector xmlns:android="http://schemas.android.com/apk/res/android">
 <item android:state_window_focused="false" android:state_enabled="true"
        android:drawable="@drawable/btn_default_normal" />
 <item android:state_window_focused="false" android:state_enabled="false"
        android:drawable="@drawable/btn_default_normal_disable" />
 ...
}}}

This XML file is a "meta drawable", allowing to compose the button drawable by describing which drawable to use depending of the state of the button. Then, if you look for a bitmap named `btn_default_normal.9.png', you'll eventually find it.

== The layer-list system ==

This principles applies for the Toggle button too, but as a toggle buttons display a little bitmap to show its status (on/off), it's a little bit different. Let's have a look at the Toggle button style, as defined in the Styles file:
{{{
<style name="Widget.Button.Toggle">
 <item name="android:background">@android:drawable/btn_toggle_bg</item>
 <item name="android:textOn">@android:string/capital_on</item>
 ...
}}}

As you can see the backround uses a `btn_toggle_bg` drawable, which is also an XML file with the following contents: 